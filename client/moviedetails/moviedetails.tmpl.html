<div class="container-fluid moviedetails-container" ng-controller="MovieDetailsCtrl as movieDetailsVM">
  <div class="row-fluid">
    <div class="col-md-2 col-md-offset-2 movie-img-col">
      <div class="movie-img">
        <img ng-src="{{movieDetailsVM.movie.poster}}" alt="movieimage">
      </div>
    </div>
    <div class="col-md-6">
      <div class="panel panel-default movie-details-header">
        <div class="panel-heading movie-details-header">
          <div class="panel-title white font-30">{{movieDetailsVM.movie.title}}
            <div class="font-20">
              <span class="orange" uib-rating ng-model="movieDetailsVM.movie.imdbRating" max="movieDetailsVM.bigmaxrate" read-only="true" titles="['1','2','3']"></span>
              <span>({{movieDetailsVM.movie.imdbRating}}) {{movieDetailsVM.movie.imdbVotes}} votes</span>
            </div>
          </div>
          <hr class="title-hr">
        </div>
        <div class="panel-body">
          <div class="font-15 movie-info">
            <ul>
              <li>{{movieDetailsVM.movie.rated}}</li>
              <li>{{movieDetailsVM.movie.language}}</li>
              <li>{{movieDetailsVM.movie.country}}</li>
            </ul>
          </div>
          <div class="font-15">
            <div>{{movieDetailsVM.movie.genre}}</div>
            <div>Released : {{movieDetailsVM.movie.released}}</div>
            <div>Runtime : {{movieDetailsVM.movie.runtime}}</div>
            <div>Directed By : {{movieDetailsVM.movie.director}}</div>
            <div>Writen By : {{movieDetailsVM.movie.writer}}</div>
            <div>Cast : {{movieDetailsVM.movie.actor}}</div>
            <div>Awards : {{movieDetailsVM.movie.awards}}</div>
            <div>Type : {{movieDetailsVM.movie.type}}</div>
            <div>
              User Rating : <span class="orange" uib-rating ng-model="movieDetailsVM.movie.userRating" max="movieDetailsVM.useredit.max" read-only="true" titles="['1','2','3']"></span>
              <span>({{movieDetailsVM.movie.userRating}})</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row-fluid">
    <div class="col-md-8 col-md-offset-2">
      <div class="font-15">Plot: {{movieDetailsVM.movie.plot}}</div>
    </div>
  </div>
  <div class="row-fluid">
    <div class="col-md-8 col-md-offset-2">
      <!--ng-href="#!/movies/edit/{{movieDetailsVM.movie.imdbId}}"-->
      <a ng-href="#!/movies/edit/{{movieDetailsVM.routeparam}}" class="btn btn-primary">Edit this movie</a>
    </div>
  </div>
  <div class="row-fluid" ng-if="!movieDetailsVM.foundCurrentUserRating">
    <div class="col-md-8 col-md-offset-2 pad-top-20">
      <div class="panel panel-default">
        <div class="panel-heading back-black">
          <div class="panel-title font-20 white">
            You have not yet rated this {{movieDetailsVM.movie.type}}!!
          </div>
        </div>
        <div class="panel-body font-15 gray">
          <div class="font-15">
            Please Rate :
            <span class="orange" uib-rating ng-model="movieDetailsVM.newRating.ratingScore" max="movieDetailsVM.useredit.max" read-only="movieDetailsVM.useredit.isReadonly" on-hover="movieDetailsVM.useredit.hoveringOver(value)" on-leave="movieDetailsVM.useredit.overStar = null"
            titles="['1','2','3']" aria-labelledby="default-rating"></span>
            <span class="label" ng-class="{'label-warning': movieDetailsVM.useredit.percent<30, 'label-info': movieDetailsVM.useredit.percent>=30 && movieDetailsVM.useredit.percent<70, 'label-success': movieDetailsVM.useredit.percent>=70}" ng-show="movieDetailsVM.useredit.overStar && !movieDetailsVM.useredit.isReadonly">{{movieDetailsVM.useredit.percent}}%</span>
            <span>({{movieDetailsVM.newRating.ratingScore}})</span>
          </div>
          <div class="form-group">
            <label for="exampleInputEmail1"><span class="glyphicon glyphicon-pencil"></span> Comment : </label>
            <textarea rows="2" class="form-control text-area" id="exampleInputEmail1" ng-model="movieDetailsVM.newRating.comments" placeholder="Comment"></textarea>
          </div>
          <div class="row-right">
            <button type="button" class="btn btn-primary" ng-click="movieDetailsVM.postUserRating()">Post</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div ng-if="movieDetailsVM.foundCurrentUserRating">
    <div class="row-fluid">
      <div class="col-md-8 col-md-offset-2 pad-top-20">
        <div class="panel panel-default" ng-if="!movieDetailsVM.useredit.edit">
          <div class="panel-heading back-black">
            <div class="panel-title white font-20 overflow-hid">
              {{movieDetailsVM.currentUserRatings.id.user.firstName}} {{movieDetailsVM.currentUserRatings.id.user.lastName}}
              <span class="orange" uib-rating ng-model="movieDetailsVM.currentUserRatings.ratingScore" max="movieDetailsVM.useredit.max" read-only="true"></span>
              <span>({{movieDetailsVM.currentUserRatings.ratingScore}})</span>
              <span class="float-right font-15">{{movieDetailsVM.currentUserRatings.timeStamp | date:'yyyy-MM-dd HH:mm:ss'}}</span>
            </div>
          </div>
          <div class="panel-body gray font-15">
            <div class="form-group">
              {{movieDetailsVM.currentUserRatings.comments}}
            </div>
            <div class="row-right">
              <button type="button" class="btn btn-primary" ng-click="movieDetailsVM.useredit.edit=true; movieDetailsVM.useredit.isReadonly = false;">Edit</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row-fluid">
      <div class="col-md-8 col-md-offset-2">
        <div class="panel panel-default" ng-if="movieDetailsVM.useredit.edit">
          <div class="panel-heading back-black">
            <div class="panel-title white font-20">
              {{movieDetailsVM.currentUserRatings.id.user.firstName}} {{movieDetailsVM.currentUserRatings.id.user.lastName}}
            </div>
          </div>
          <div class="panel-body gray white font-15">
            Please Rate :
            <span class="orange" uib-rating ng-model="movieDetailsVM.currentUserRatings.ratingScore" max="movieDetailsVM.useredit.max" read-only="movieDetailsVM.useredit.isReadonly" on-hover="movieDetailsVM.useredit.hoveringOver(value)" on-leave="movieDetailsVM.useredit.overStar = null"
            titles="['1','2','3']" aria-labelledby="default-rating"></span>
            <span class="label" ng-class="{'label-warning': movieDetailsVM.useredit.percent<30, 'label-info': movieDetailsVM.useredit.percent>=30 && movieDetailsVM.useredit.percent<70, 'label-success': movieDetailsVM.useredit.percent>=70}" ng-show="movieDetailsVM.useredit.overStar && !movieDetailsVM.useredit.isReadonly">{{movieDetailsVM.useredit.percent}}%</span>
            <span>({{movieDetailsVM.currentUserRatings.ratingScore}})</span>
            <div class="form-group">
              <label for="exampleInputEmail1"><span class="glyphicon glyphicon-pencil"></span> Comment : </label>
              <textarea rows="2" class="form-control text-area" ng-model="movieDetailsVM.currentUserRatings.comments" placeholder="Comment"></textarea>
            </div>
            <div class="row-right">
              <button type="button" class="btn btn-primary" ng-click="movieDetailsVM.putUserRating()">Update</button>
              <button type="button" class="btn btn-danger" ng-click="movieDetailsVM.useredit.edit=false;">Cancel</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row-fluid">
    <div class="col-md-8 col-md-offset-2">
      <hr>
      <div class="font-20">See what others have to say : </div>
    </div>
  </div>
  <div class="row-fluid" ng-repeat="otherRating in movieDetailsVM.otherRatings">
    <div class="col-md-8 col-md-offset-2 pad-top-20">
      <div class="panel panel-default">
        <div class="panel-heading back-black white">
          <div class="font-20 white overflow-hid">
            {{otherRating.user.firstName}} {{otherRating.user.lastName}}
            <span class="orange" uib-rating ng-model="otherRating.ratingScore" max="movieDetailsVM.smallmaxrate" read-only="true" titles="['1','2','3']" aria-labelledby="default-rating"></span>
            <span>({{otherRating.ratingScore}})</span>
            <span class="float-right font-15">{{otherRating.timeStamp | date:'yyyy-MM-dd HH:mm:ss'}}</span>
          </div>
        </div>
        <div class="panel-body gray font-15">
          {{otherRating.comments}}
        </div>
      </div>
    </div>
  </div>
</div>